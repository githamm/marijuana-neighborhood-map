<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Denver Marijuana Neighborhood Map</title>
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <link rel="canonical" href="http://extras.denverpost.com/maps/news/marijuana/licensed-facilities/index.html" />
    <link rel="shortcut icon" href="http://extras.mnginteractive.com/live/media/favIcon/dpo/favicon.ico" type="image/x-icon" />
    <meta name="distribution" content="global" />
    <meta name="robots" content="index, nofollow" />
    <meta name="title" content="Map of Denver marijuana facilities by neighborhood" />
    <meta name="language" content="en, sv" />
    <meta name="Copyright" content="Copyright &copy; The Denver Post." />
    <link rel="author" href="humans.txt" />
    <meta name="description" content="A map of Denver marijuana facilities by neighborhood with Census income data, school locations.">
    <meta name="news_keywords" content="Colorado, Denver, marijuana, pot, cultivation">
    <meta name="twitter:card" value="summary" />
    <meta name="twitter:url" value="http://dpo.st/potmap" />
    <meta name="twitter:title" value="Map of Denver marijuana facilities by neighborhood" />
    <meta name="twitter:description" value="A map of Denver marijuana facilities by neighborhood with Census income data, school locations." />
    <meta name="twitter:image" value="images/pot-image.jpg" />
    <meta name="twitter:site" value="@denverpost" />
    <meta name="twitter:domain" value="denverpost.com" />
    <meta name="twitter:creator" content="@denverpost">
    <meta name="twitter:app:name:iphone" value="Denver Post">
    <meta name="twitter:app:name:ipad" value="Denver Post">
    <meta name="twitter:app:name:googleplay" value="The Denver Post">
    <meta name="twitter:app:id:iphone" value="id375264133">
    <meta name="twitter:app:id:ipad" value="id409389010">
    <meta name="twitter:app:id:googleplay" value="com.ap.denverpost" />
    <meta property="fb:app_id" content="105517551922" />
    <meta property="og:title" content="Map of Denver marijuana facilities by neighborhood" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://dpo.st/potmap" />
    <meta property="og:image" content="http://extras.denverpost.com/maps/news/marijuana/licensed-facilities/images/pot-image.jpg" />
    <meta property="og:site_name" content="The Denver Post" />
    <meta property="og:description" content="A map of Denver marijuana facilities by neighborhood with Census income data, school locations." />
    <meta property="article:publisher" content="https://www.facebook.com/denverpost" />
    <meta name="google-site-verification" content="2bKNvyyGh6DUlOvH1PYsmKN4KRlb-0ZI7TvFtuKLeAc" />

    <!-- STYLE SHEETS -->
    <link href="css/leaflet.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <!-- http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css -->
    <link href='https://fonts.googleapis.com/css?family=Oswald:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://extras.denverpost.com/transgender/css/foundation.min.css" />
    <link rel="stylesheet" href="http://extras.denverpost.com/transgender/css/normalize.css" />
    
    <!-- SCRIPTS -->
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js">
    </script>
    <script src="js/leaflet-grouped-layer-control.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js">
    </script>

    <script>
        var iframe = '';
        if ( document.location.hash === '#iframe' ) iframe = 1;
        if ( window.top !== window.self ) { iframe = 1; }
        if ( iframe === '' ) {
        //Chartbeat startup
        var _sf_startpt=(new Date()).getTime();
        var _sf_async_config={};

        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        (function() {
          var useSSL = "https:" == document.location.protocol;
          var src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
          document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
         })();
        }
    </script>
</head>
<body>
    <!-- GOOGLE TAG MANAGER DATA LAYER -->
    <script>
      var is_mobile = function() {
        var check = false;
        (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
        if ( check == true ) return 'YES';
        return 'NO';
      };
      analyticsEvent = function() {};
      analyticsSocial = function() {};
      analyticsVPV = function() {};
      analyticsClearVPV = function() {};
      analyticsForm = function() {};
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
          'ga_ua':'UA-61435456-7',
          'quantcast':'p-4ctCQwtnNBNs2',
          'quantcast label': 'Denver',
          'comscore':'6035443',
          'errorType':'',
          'Publisher Domain':'denverpost.com',
          'Publisher Product':'denverpost.com',
          'Dateline':'',
          'Publish Hour of Day':'',
          'Create Hour of Day':'',
          'Update Hour of Day':'',
          'Behind Paywall':'NO',
          'Mobile Presentation':is_mobile(),
          'kv':'lifestyle',
          'Release Version':'',
          'Digital Publisher':'denverpost.com',
          'Platform':'custom',
          'Section':'News',
          'Taxonomy1':'Marijuana',
          'Taxonomy2':'Special Projects',
          'Taxonomy3':'Denver Marijuana Map',
          'Taxonomy4':'',
          'Taxonomy5':'',
          'Content Source':'extras.denverpost.com',
          'Canonical URL': 'http://extras.denverpost.com' + document.location.pathname,
          'Slug':document.location.pathname,
          'Content ID':'',
          'Page Type':'directory',
          'Publisher State':'CO',
          'Byline':'',
          'Content Title':document.title,
          'URL':document.location.href,
          'Page Title':document.title,
          'User ID':''
      });
    </script>
    <!-- End Google Tag Manager Data Layer -->
    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TLFP4R" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>
    (function(w,d,s,l,i) {
       w[l]=w[l]||[];
       w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
       var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
       j.async=true;
       j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })
    (window,document,'script','dataLayer','GTM-TLFP4R');
    </script>
    <!-- End Google Tag Manager -->

    <!-- Header section -->
    <div id="hide-iframe">
        <nav class="top-bar" data-topbar role="navigation">
          <ul class="title-area">
            <li class="name">
            <a href="http://denverpost.com">
            <img class="nav-logo" src="http://extras.denverpost.com/candidate-qa/denver-2015/images/dp-logo-white.png" alt="The Denver Post logo" class="nav-logo">
          </a>

            </li>
          </ul>
        </nav>

        <!-- Social media buttons -->
        <div class="row">
        <div class="large-12 medium-12 columns">
          <ul class="post-meta-social-links text-center no-bullet" id="sticky-inner">
            <li class="post-meta-social ho-list">
              <a href="mailto:?subject=Denver%20marijuana%20map%20"><img class="social-icons" src="images/email-icon.png" alt="Email this to a friend"></a>
            </li>
            <li class="post-meta-social pm-twitter ho-list">
              <a href="javascript:void(0)" onclick="javascript:window.open('http://twitter.com/share?text=Map%20of%20Denver%20marijuana%20facilities%20by%20neighborhood%20from%20The%20Denver%20Post&amp;url=http%3A%2F%2Fdpo.st%2Fpotmap&amp;via=denverpost', 'twitwin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=1');"><img class="social-icons" src="http://extras.denverpost.com/projects/2014/latino-project/images/social-twitter.png" alt="Tweet this story"></a>
            </li>
            <li class="post-meta-social pm-facebook text-center ho-list">
              <a href="javascript:void(0)" onclick="javascript:window.open('http://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=http%3A%2F%2Fdpo.st%2Fpotmap&amp;p[images][1]=&amp;p[title]=Map%20of%20Denver%20marijuana%20facilities%20by%20neighborhood%20with%20Census%20income%20data%2C%20school%20locations%20from%20The%20Denver%20Post&amp;p[summary]=Map+of+Denver+marijuana+facilities+by+neighborhood+with+Census+income+data+and+school+locations', 'fbwin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=1');"><img class="social-icons" src="http://extras.denverpost.com/projects/2014/latino-project/images/social-facebook.png" alt="Facebook"></a>
            </li>
            <div class="clear"></div>
          </ul>
        </div>
      </div>
    </div>
    <div id="container">
    <div class="row">
        <div class="large-12 columns">
            <h1 class="intro">MARIJUANA IN DENVER: SOME AREAS SATURATED</h1>
            <p>A Denver Post analysis of marijuana-related business license records shows there are more than 600 entities operating within city limits, including medical and retail stores, cultivation centers, edible manufacturers and testing facilities. Businesses are concentrated in the northern and western areas of the city, mainly due to zoning restrictions and available warehouse space for cultivation operations. The three neighborhoods that house the highest number of businesses are Elyria Swansea (78), Northeast Park Hill (67) and Montbello (52).</p>
            <hr class="not-popup">
            <p><strong><span style="color: rgba(227,26,28,1.0)">HOW TO USE THE MAP</span></strong> Click the red icon in the top right corner of the map to add and remove features, including locations of marijuana facilities, schools, Census income and population data, and zoning overlays. Toggle facility types to reveal overlapping map markers <a href="#overlapping-markers">(more about this)</a>. Click a neighborhood, Census tract or map marker for details. <em>Read about our methodology and <a href="#methodology">why our numbers are different than the city's.</a></em></p>
        </div>
    </div>

    <div class="row" id="legend-container">
        <div class="large-4 medium-4 columns legend-spacing">
            <div id="dot-legend">
                <p class="legend-title">MARIJUANA FACILITY TYPES</p>
                <div id="icon-store-legend"></div> Store<br>
                <div id="icon-cultivation-legend"></div> Cultivation facility</br>
                <div id="icon-manufacturing-legend"></div> Manufacturing facility</br>
                <div id="icon-test-facility-legend"></div> Testing facility</br>
            </div>
        </div>
        <div class="large-4 medium-4 columns legend-spacing">
            <div id="facilities-number">
                <p class="legend-title">NUMBER OF MARIJUANA<br>BUSINESSES</p>
                <ul class="legend">
                    <li><span>0</span></li>
                    <li><span class="step-1"></span></li>
                    <li><span class="step-2"></span></li>
                    <li><span class="step-3"></span></li>
                    <li><span class="step-4"></span></li>
                    <li><span class="step-5">78</span></li>
                </ul>
            </div>
        </div>
        <div class="large-4 medium-4 columns legend-spacing">
            <div id="median-income">
                <p class="legend-title">MEDIAN HOUSEHOLD<br>INCOME</p>
                <ul class="legend">
                    <li><span>0</span></li>
                    <li><span class="step-6"></span></li>
                    <li><span class="step-7"></span></li>
                    <li><span class="step-8"></span></li>
                    <li><span class="step-9"></span></li>
                    <li><span class="step-10">$158K</span></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="large-12 columns">
            <div id="map"></div>
        </div>
    </div>

    <div class="row">
        <div class="large-12 columns">
                <div class="legend-container">
                    <p style="font-style: italic; text-align: right;">Sources: City and County of Denver Dept. of Excise and License, Colorado Dept. of Education, U.S. Census</p>
                    <p id="methodology"><strong>OUR METHODOLOGY</strong> The Denver Post analyzed marijuana-related business license information from the City and County of Denver Department of Excise and Licenses. The analysis resulted in a higher number of distinct marijuana business locations <a href="http://denvergov.org/content/denvergov/en/denver-marijuana-information/statistics/licensing-and-locations.html" target="_top">than the city shows</a>, due to how address information is handled. The city counts one structure as one location regardless of the number of license-holders operating within it (for example, multiple units in one building). We counted multiple license-holders in one building as separate entities unless we could determine they were licensed as one entity.</p>
                    <p id="overlapping-markers"><strong>A NOTE ABOUT OVERLAPPING MAP MARKERS</strong> If multiple entities of the same facility type operate at the same address (for example, several cultivation businesses located in different units in one building), the map markers will overlap and details for only one of the businesses will show. The separate businesses are included in the neighborhood totals. If multiple entities of different facility types operate at the same address, the map markers will overlap but will display when the facility type's map layer is toggled.</p>
                    <p><em>*U.S. Census data is from the 2013 American Community Survey; income levels are median household income.</em></p> 
                </div>
            </div>
        </div>
        </div>

    <script>
        var neighborhoods = new L.LayerGroup();
        var noStoresZoning = new L.LayerGroup();
        var noManufacturersZoning = new L.LayerGroup();
        var census = new L.LayerGroup();
        var stores = new L.LayerGroup();
        var cultivation = new L.LayerGroup();
        var manufacturing = new L.LayerGroup();
        var testFacilities = new L.LayerGroup();
        var elementarySchools = new L.LayerGroup();
        var middleSchools = new L.LayerGroup();
        var highSchools = new L.LayerGroup();

        var mapLink = '<a href="http://www.esri.com/">Esri<\/a>';
        var wholink = 'i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community';

        var light = L.tileLayer('http://{s}.{base}.maps.cit.api.here.com/maptile/2.1/{type}/{mapID}/reduced.day/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}', {
            attribution: 'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',
            subdomains: '1234',
            mapID: 'newest',
            app_id: '2K8wqfYF2CuD5D67HdQx',
            app_code: '5PforzMWCWQoYPBUP-0p_A',
            base: 'base',
            maxZoom: 20,
            type: 'maptile',
            language: 'eng',
            format: 'png8',
            size: '256'
        });

        /* dark = L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap<\/a> &copy; <a href="http://cartodb.com/attributions">CartoDB<\/a>',
                subdomains: 'abcd',
                maxZoom: 19
        }), */

        /* streets = L.tileLayer('http://{s}.{base}.maps.cit.api.here.com/maptile/2.1/{type}/{mapID}/normal.day.grey/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}', {
            attribution: 'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',
            subdomains: '1234',
            mapID: 'newest',
            app_id: '2K8wqfYF2CuD5D67HdQx',
            app_code: '5PforzMWCWQoYPBUP-0p_A',
            base: 'base',
            maxZoom: 20,
            type: 'maptile',
            language: 'eng',
            format: 'png8',
            size: '256'
        }); */

        streets = L.tileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/{type}/{z}/{x}/{y}.{ext}', {
            type: 'map',
            ext: 'jpg',
            attribution: 'Tiles Courtesy of <a href="http://www.mapquest.com/">MapQuest<\/a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap<\/a>',
            subdomains: '1234'
        }),

        satellite = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: '&copy; ' + mapLink + ', ' + wholink,
            maxZoom: 18
        });

        var baseLayers = {
            "Neighborhood map": light,
            "Street map": streets,
            "Satellite map": satellite
        };

        // grouped layer control from http://bl.ocks.org/ismyrnow/6123517
        var groupedOverlays = {
            "Background": {
                "Neighborhoods": neighborhoods,
                "Income levels": census,
                "Zoning: No stores": noStoresZoning,
                "Zoning: No manufacturers": noManufacturersZoning
            },
            "Facilities": {
                "Stores": stores,
                "Cultivation facilities": cultivation,
                "Manufacturing facilities": manufacturing,
                "Testing facilities": testFacilities
            },
            "Schools": {
                "Elementary schools": elementarySchools,
                "Middle schools": middleSchools,
                "High schools": highSchools
            }
        };

        // map from http://bl.ocks.org/awoodruff/3ce5d735126a56dfff94
        // initialize the map
        var map = L.map('map', {
            center: [39.72, -104.94],
            zoom: 12,
            layers: [light, neighborhoods, stores, cultivation, manufacturing, testFacilities]
        });

        // below from http://maptimeboston.github.io/leaflet-intro/
        $.getJSON("js/denver-neighborhoods-count-geojson.js", function(data) {
            L.geoJson(data, {
                style: function(feature) {
                    var fillColor,
                        density = feature.properties.count_all;
                    if (density > 60) fillColor = "#a63603";
                    else if (density > 40) fillColor = "#e6550d";
                    else if (density > 20) fillColor = "#fd8d3c";
                    else if (density > 10) fillColor = "#fdbe85";
                    else if (density > 0) fillColor = "#feedde";
                    else fillColor = "rgba(0,0,0,0)"; // no data
                    return {
                        color: "#000",
                        weight: 1,
                        fillColor: fillColor,
                        fillOpacity: .6
                    };
                },
                onEachFeature: function(feature, layer) {
                    layer.bindPopup(
                        '<strong>' + feature.properties.nbhd_name + '<br/>' 
                        + feature.properties.count_all + '<\/strong>' + ' marijuana businesses' + '<hr class="popup">'
                        + 'Stores: ' + feature.properties.count_stores + '<br/>'
                        + 'Cultivation: ' + feature.properties.count_cultivation + '<br/>'
                        + 'Manufacturing: ' + feature.properties.count_manufacturing + '<br/>'
                        + 'Testing: ' + feature.properties.count_testing
                    )
                }
            }).addTo(neighborhoods);
        });

        $.getJSON("js/acs-2013-tract-geojson.js", function(data) {
            L.geoJson(data, {
                style: function(feature) {
                    var fillColor,
                        density = feature.properties.med_hh_inc;
                    if (density > 100000) fillColor = "#54278f";
                    else if (density > 75000) fillColor = "#756bb1";
                    else if (density > 50000) fillColor = "#9e9ac8";
                    else if (density > 25000) fillColor = "#cbc9e2";
                    else if (density > 0) fillColor = "#f2f0f7";
                    else fillColor = "rgba(0,0,0,0)"; // no data
                    return {
                        color: "#000",
                        weight: 1,
                        fillColor: fillColor,
                        fillOpacity: .6
                    };
                },
                onEachFeature: function(feature, layer) {
                    layer.bindPopup(
                        '<strong>' + 'Tract No. ' + feature.properties.geo_name + '</strong><hr class="popup">'
                        + 'Median income: ' + '$' + feature.properties.med_hh_inc + '<br/>'
                        + 'Population: ' + feature.properties.ttl_popula + '<br/>'
                        + 'Pct. under 18: ' + feature.properties.ageless18_pct + '%'
                    )
                }
            }).addTo(census);
        });

        $.getJSON("js/zoning-no-stores-geojson.js", function(data) {
            L.geoJson(data, {
                style: function(feature) {
                    var fillColor,
                        density = feature.properties.count_all;
                    if (density > 60) fillColor = "#08519c";
                    else if (density > 40) fillColor = "#3182bd";
                    else if (density > 20) fillColor = "#6baed6";
                    else if (density > 10) fillColor = "#bdd7e7";
                    else if (density > 0) fillColor = "#eff3ff";
                    else fillColor = "#ffffc2"; // no data
                    return {
                        color: "#000",
                        weight: 1,
                        fillColor: fillColor,
                        fillOpacity: .6
                    };
                }
            }).addTo(noStoresZoning);
        });

        $.getJSON("js/zoning-no-manufacturers-geojson.js", function(data) {
            L.geoJson(data, {
                style: function(feature) {
                    var fillColor,
                        density = feature.properties.count_all;
                    if (density > 60) fillColor = "#08519c";
                    else if (density > 40) fillColor = "#3182bd";
                    else if (density > 20) fillColor = "#6baed6";
                    else if (density > 10) fillColor = "#bdd7e7";
                    else if (density > 0) fillColor = "#eff3ff";
                    else fillColor = "#ffffc2"; // no data
                    return {
                        color: "#000",
                        weight: 1,
                        fillColor: fillColor,
                        fillOpacity: .6
                    };
                }
            }).addTo(noManufacturersZoning);
        });

        $.getJSON("js/stores-geojson.js", function(data) {
            var mapIcon = L.divIcon({
                //iconUrl: 'images/circle-red.png',
                className: 'icon-store',
                iconSize: [9, 9]
                //iconAnchor: [6, 3],
                //popupAnchor: [-1, -5]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        feature.properties.Entity_Name 
                        + '<br/>' 
                        + ' dba '
                        + feature.properties.Trade_Name
                        + '<br/>'
                        + feature.properties.Address
                        + '<hr class="popup">'
                        + feature.properties.Facility_Type
                        + ': ' 
                        + feature.properties.Market_Served
                    );
                    return marker;
                }
            }).addTo(stores);
        });

        $.getJSON("js/cultivation-geojson.js", function(data) {
            var mapIcon = L.divIcon({
                //iconUrl: 'images/circle-yellow.png',
                className: 'icon-cultivation',
                iconSize: [9, 9]
                //iconAnchor: [6, 3],
                //popupAnchor: [-1, -5]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        feature.properties.Entity_Name 
                        + '<br/>' 
                        + ' dba '
                        + feature.properties.Trade_Name
                        + '<br/>'
                        + feature.properties.Address
                        + '<hr class="popup">'
                        + feature.properties.Facility_Type
                        + ': ' 
                        + feature.properties.Market_Served
                    );
                    return marker;
                }
            }).addTo(cultivation);
        });

        $.getJSON("js/manufacturing-geojson.js", function(data) {
            var mapIcon = L.divIcon({
                //iconUrl: 'images/circle-green.png',
                className: 'icon-manufacturing',
                iconSize: [9, 9]
                //iconAnchor: [6, 3],
                //popupAnchor: [-1, -5]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        feature.properties.Entity_Name 
                        + '<br/>' 
                        + ' dba '
                        + feature.properties.Trade_Name
                        + '<br/>'
                        + feature.properties.Address
                        + '<hr class="popup">'
                        + feature.properties.Facility_Type
                        + ': ' 
                        + feature.properties.Market_Served
                    );
                    return marker;
                }
            }).addTo(manufacturing);
        });

        $.getJSON("js/test-facilities-geojson.js", function(data) {
            var mapIcon = L.divIcon({
                //iconUrl: 'images/circle-blue.png',
                className: 'icon-test-facility',
                iconSize: [9, 9]
                //iconAnchor: [6, 3],
                //popupAnchor: [-1, -5]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        feature.properties.Entity_Name 
                        + '<br/>' 
                        + ' dba '
                        + feature.properties.Trade_Name
                        + '<br/>'
                        + feature.properties.Address
                        + '<hr class="popup">'
                        + feature.properties.Facility_Type
                        + ': ' 
                        + feature.properties.Market_Served
                    );
                    return marker;
                }
            }).addTo(testFacilities);
        });

        $.getJSON("js/denver-schools-elementary-geojson.js", function(data) {
            var mapIcon = L.icon({
                iconUrl: 'images/elementary-school.png',
                iconSize: [20, 20],
                iconAnchor: [6, 3],
                popupAnchor: [3, 0]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        '<strong>' + feature.properties.school + '</strong>'
                        + '<br/>' + feature.properties.school_type + ' School'
                        + '<hr class="popup">' 
                        + feature.properties.street
                        + '<br/>'
                        + feature.properties.city + ' ' + feature.properties.zip
                    );
                    return marker;
                }
            }).addTo(elementarySchools);
        });

        $.getJSON("js/denver-schools-middle-geojson.js", function(data) {
            var mapIcon = L.icon({
                iconUrl: 'images/middle-school.png',
                iconSize: [20, 20],
                iconAnchor: [6, 3],
                popupAnchor: [3, 0]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        '<strong>' + feature.properties.school + '</strong>'
                        + '<br/>' + feature.properties.school_type + ' School'
                        + '<hr class="popup">' 
                        + feature.properties.street
                        + '<br/>'
                        + feature.properties.city + ' ' + feature.properties.zip
                    );
                    return marker;
                }
            }).addTo(middleSchools);
        });

        $.getJSON("js/denver-schools-high-geojson.js", function(data) {
            var mapIcon = L.icon({
                iconUrl: 'images/high-school.png',
                iconSize: [20, 20],
                iconAnchor: [6, 3],
                popupAnchor: [3, 0]
                // icons from https://www.iconfinder.com/icons/73019/ball_base_chartreuse_map_marker_right_tv_icon#size=32
            });
            L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var marker = L.marker(latlng, {
                        icon: mapIcon
                    });
                    marker.bindPopup(
                        '<strong>' + feature.properties.school + '</strong>'
                        + '<br/>' + feature.properties.school_type + ' School'
                        + '<hr class="popup">' 
                        + feature.properties.street
                        + '<br/>'
                        + feature.properties.city + ' ' + feature.properties.zip
                    );
                    return marker;
                }
            }).addTo(highSchools);
        });

        L.control.groupedLayers(baseLayers, groupedOverlays).addTo(map);
    </script>

    <script src="http://extras.denverpost.com/foundation/js/foundation.min.js"></script>
    <script>
       $(document).foundation();
    </script>

    <footer>
        <div class="row">
            <div class="large-12 columns">
                <script type="text/javascript">
                    //Chartbeat stuff
                    _sf_async_config.uid = 2671;
                    _sf_async_config.domain = 'denverpost.com';
                    _sf_async_config.sections = 'marijuana,data';
                    _sf_async_config.useCanonical = true;
                    (function(){
                        function loadChartbeat() {
                            window._sf_endpt=(new Date()).getTime();
                            var e = document.createElement('script');
                            e.setAttribute('language', 'javascript');
                            e.setAttribute('type', 'text/javascript');
                            e.setAttribute('src','//static.chartbeat.com/js/chartbeat.js');
                            document.body.appendChild(e);
                        }
                        var oldonload = window.onload;
                        window.onload = (typeof window.onload != 'function') ? loadChartbeat : function() { oldonload(); loadChartbeat(); };
                    })();
                </script>
                <hr>
                <p style="font-style: italic; text-align: right;">By Kevin Hamm / Copyright &copy; 2016 <a href="http://www.denverpost.com/">The Denver Post</a></p>
            </div>
        </div>
    </footer>

    <script>
      // Hide Google analytics if #iframe in url
      if ( iframe === 1 ) {
          $('#google-analytics').remove()
        }
        
      // If #iframe in url, hide header section and footer
      if ( iframe === 1 ) {
        $('#hide-iframe, footer').addClass('hide');
      }
    </script>
</body>
</html>